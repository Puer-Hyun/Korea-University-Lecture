# 2023-06-01-(목)-210204
## 목표
* 모든 코드는 from-scratch로 돌려보고, Recbole로도 실험을 해봐야겠다.
## NBCF
1. `knn_basic = KNNBasic(k=40, min_k=10)`으로 진행하니 학습시간만 한참 걸렸음. 
   * 위 코드는 3.8.5 recsys 가상환경에서 돌렸음.

## Recbole 연결
###  문제점
1. distutils라는 라이브러리가 3.8.5 에서는 동작하지 않는 것 같은데, 조현석 멤버는 돌렸다고 해서 3.8.16 버전을 설치하고 새로운 가상환경을 설치하려고 함.
2. recbole이 돌아가는 것 같긴 한데, wandb 설정, tensorboard 설정 등 설정할 수 있는 게 너무 많은 것 같다. 
3. 우선은 train_df 를 1%만 사용해서 데이터를 확 축소시켜서 전체 사이클을 돌려봐야겠다. 현재는 5백만개니까 짧은 실험이 감당이 되지 않는다.
4. 1%만 사용해서 돌리는 것은 성공했는데, run.py는 성공했으나 run_hyper.py는 아직 작동시키는 법을 모르겠다. 
   1. Hyperopt / numpy 버전 문제인 줄 알았는데 그건 아닌 것 같다.
   2. 모델마다 Config file을 어떻게 다뤄야하는 지 익혀야 할 것 같은데?

---
When I try to run fmin and define rstate as np.random.RandomState(SEED), I got the error

'numpy.random.mtrand.RandomState' object has no attribute 'integers'

My fmin call looks like this:
fmin(f_lgbm, lgbm_param, algo=tpe.suggest, max_evals=MAX_EVAL, trials=trials, rstate=np.random.RandomState(SEED))

I am running the latest hyperopt on conda python 3.8.6 on win11.

즉, Hyperopt를 관리하는 과정에서 numpy에서는 numpy.random.mtrand.RandomState라는 것이 없어졌다. 

<span style="color:red">

np.random.RandomState was deprecated, so Hyperopt now uses np.random.Generator. Replace the fmin call with:

fmin(f_lgbm, lgbm_param, algo=tpe.suggest, max_evals=MAX_EVAL, trials=trials, rstate=np.random.default_rng(SEED))

</span>

---


# 2023-06-02-(금)-102543
## 목표 
* 나가기 전까지 Hyper 실험할 수 있는 환경까지 만들어보기?
  * 그냥 Wandb Sweep으로 해결했음. 
* 이제 다음 목표는 Valid Set 구축이다. 고정된 hyperparam에 대해서 단일모델을 여러 train, valid에 돌려 보았을 때, 가장 Robust한 것은 무엇인가?
* BPR 을 돌려보니까, 0.016이 최대이다. (1%에서)